{% extends 'admin_base.html' %}

{% block content %}
<title>{{ operation }} Region Member Position</title>
<!-- Select2 CSS and JS -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<div class="min-h-screen bg-gray-50 py-8">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b border-gray-200">
                <h2 class="text-xl font-semibold text-gray-800">{{ operation }} Region Member Position</h2>
            </div>
            
            <div class="px-6 py-4">
                <form method="post">
                    {% csrf_token %}
                    
                    <div class="space-y-6">
                        <div>
                            <label for="user" class="block text-sm font-medium text-gray-700 mb-1">User</label>
                            <select name="user" id="user" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                                <option></option>
                                {% for user in users %}
                                <option value="{{ user.id }}" {% if position and position.user.id == user.id %}selected{% endif %}>
                                    {{ user.first_name }} {{ user.last_name }} ({{ user.email }})
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <div>
                            <label for="position" class="block text-sm font-medium text-gray-700 mb-1">Position</label>
                            <select name="position" id="position" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                                {% for pos in positions %}
                                <option value="{{ pos.id }}" {% if position and position.position.id == pos.id %}selected{% endif %}>
                                    {{ pos.RegionpositionName }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <div>
                            <label for="region" class="block text-sm font-medium text-gray-700 mb-1">Region</label>
                            <select name="region" id="region" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" required>
                                {% for reg in regions %}
                                <option value="{{ reg.id }}" {% if position and position.region.id == reg.id %}selected{% endif %}>
                                    {{ reg.region_name }} in {{ reg.city.city_name }}, {{ reg.country.country_name }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="flex justify-end space-x-3 pt-4">
                            <a href="{% url 'region_member_position_list' %}" 
                               class="inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                Back to List
                            </a>
                            <button type="submit" 
                                    class="inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                {{ operation }}
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        $('#user').select2({
            placeholder: "Search and select a user",
            allowClear: true,
            width: '100%',
            // Custom styles for Select2 to match Tailwind design
            theme: 'default select2-container--focus:border-indigo-500'
        });
    });
</script>

<style>
    /* Custom styles to make Select2 match Tailwind design */
    .select2-container--default .select2-selection--single {
        @apply rounded-md border-gray-300 shadow-sm;
        height: 38px;
        padding-top: 4px;
    }
    .select2-container--default .select2-selection--single .select2-selection__arrow {
        height: 36px;
    }
    .select2-dropdown {
        @apply border-gray-300 shadow-lg rounded-md;
    }
    .select2-search__field {
        @apply rounded-md border-gray-300;
    }
    .select2-results__option--highlighted[aria-selected] {
        @apply bg-indigo-600;
    }
</style>
{% endblock %}